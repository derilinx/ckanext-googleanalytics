{% extends "user/read_base.html" %}

{% import 'macros/form.html' as form %}

{% block primary_content_inner %}

    {% block ga_header %}
        <h1>
            Google Analytics Report
        </h1>
        <h5>Hint: </h5>
        <p>
            The maximum allowed period is 6 months. Once generate button is clicked,
            the task is run as background job and will take some time to reflect on the below table.
            1st row of the table is always the result of the recent run.
        </p>
        <br>
    {% endblock %}

    {% block ga_form %}
        {% set site_code = data_dict.site_code or default_selected %}
        <form id="ga-report" class="dataset-form" method="post" action="{{ action }}" data-module="basic-form">
            {{ form.input('from_dt', label=_('From Date'), type='date', value=data_dict.from_dt, error=errors.from_dt,
                classes=[], attrs={'class': 'form-control'}, is_required=true) }}
            {{ form.input('to_dt', label=_('To Date'), type='date', value=data_dict.to_dt, error=errors.to_dt,
                classes=[], attrs={'class': 'form-control'}, is_required=true) }}
            {% if is_odm %}
                {{ form.select('site_code', id='site_code', label=_('Select Site'), options=form_options,
                    selected=site_code, is_required=true) }}
            {% endif %}
            <button class="btn btn-primary" type="submit" name="run">{{ _("Generate Report") }}</button>
        </form>
    {% endblock %}


    {% if table_data %}
        {% snippet 'user/snippets/ga_table.html', table_data=table_data %}

        {% block clear_form %}
            <form id="ga-clear-data" class="dataset-form" method="post" action="{{ action }}" data-module="basic-form">
                <button class="btn btn-warning" type="submit" name="clear">{{ _("Clear Data") }}</button>
            </form>
            <p class="empty">
                 Note: This will clear all (clears the ga reports db table) the previous generated reports
                for the current site.
            </p>
        {% endblock %}

    {% else %}
       <h4 class="empty">
         No recent runs. Please press Generate Report giving suitable start and end date to see the reports here.
           Maximum allowed period is 6 months
       </h4>
    {% endif %}

{% endblock %}
